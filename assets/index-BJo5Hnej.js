import{j as e,O as A,r as u,Q as k,M as D,b as L,d as E,n as Y,l as P,e as $,h as I,f as B,g as R,K as T,i as H}from"./index-DaK327To.js";import{e as V}from"./edit-iaQC2oZw.js";import{s as q,z as N}from"./zod-Bs86SuPh.js";function z({showIndicator:t,options:c=[],className:p,classNamePrefix:C,value:h,onChange:n,placeholder:d="Select...",isLoading:x,maxheight:g,position:b="auto",...l}){const{isMulti:o}={...l},j=r=>{n(o?r==null?void 0:r.map(i=>i):r)},m=r=>{const{data:i}=r,f=u.useRef(null),[y,S]=u.useState(!1);return u.useEffect(()=>{f.current&&S(f.current.offsetWidth<f.current.scrollWidth)},[i.label]),e.jsxs(k.Option,{...r,children:[e.jsx("div",{ref:f,"data-tooltip-id":`tooltip-${i.value}`,"data-tooltip-content":y?i.label:"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i.label}),y&&e.jsx(D,{id:`tooltip-${i.value}`,place:"top"})]})};return e.jsx(A,{menuPlacement:b,maxMenuHeight:g,isLoading:x,classNamePrefix:C,value:h,onChange:j,className:`${p} ${o?"multiple-select":""} react-select-container p-1`,placeholder:d,options:c,isClearable:!0,styles:{menuPortal:r=>({...r,zIndex:9999})},menuPortalTarget:document.body,components:{...!t&&{DropdownIndicator:()=>null,IndicatorSeparator:()=>null},Option:m},...l})}const W=N.object({name:N.string().nonempty("Name is required").max(20,"Name must be 10 characters or less"),categoryId:N.string().nonempty("Category is required")});function G({showModal:t,closeModal:c,onRefreshSubCategory:p}){const{register:C,handleSubmit:h,formState:{errors:n},setValue:d,reset:x,watch:g}=L({resolver:q(W),defaultValues:{name:"",categoryId:""}}),{postData:b,patchData:l,isLoading:o,getCategory:j,getAllCategory:m}=E(s=>s),r=g("categoryId");u.useEffect(()=>{j()},[]),u.useEffect(()=>{t!=null&&t.id&&(m==null?void 0:m.length)>0?(d("name",(t==null?void 0:t.name)||""),d("categoryId",(t==null?void 0:t.categoryId)||"")):t!=null&&t.id||x()},[t==null?void 0:t.id,m]);const i=(m==null?void 0:m.map(s=>({label:s.name,value:s.id})))||[],f=s=>{t!=null&&t.id?l({id:t.id,...s},()=>{p()}):b(s,()=>{p()}),c()},y=()=>e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"modal-title",children:t!=null&&t.id?"Edit Sub Category":"Add Sub Category"}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:c})]}),S=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"set-dealine-wrp",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-6",children:e.jsxs("div",{className:"form-group forms-custom",children:[e.jsxs("label",{htmlFor:"categoryId",className:"label",children:["Select Category",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(z,{options:i,value:i.find(s=>s.value===r)||null,onChange:s=>{d("categoryId",(s==null?void 0:s.value)||"")},placeholder:"Select Category",showIndicator:!1,className:"form-select form-control"}),n.categoryId&&e.jsx("span",{className:"error",children:n.categoryId.message})]})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("div",{className:"form-group forms-custom",children:[e.jsxs("label",{htmlFor:"name",className:"label",children:["Name",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",id:"name",className:"form-control",autoComplete:"off",maxLength:20,...C("name")}),n.name&&e.jsx("span",{className:"error",children:n.name.message})]})})]})})})}),a=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-footer bottom-btn-sec",children:[e.jsx("button",{type:"button",className:"btn btn-cancel",onClick:c,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-submit",disabled:o,onClick:h(f),children:o?"Loading...":"Save"})]})});return e.jsx(Y,{className:"modal fade category-modal show",dialgName:"modal-dialog-scrollable",show:!!t,closeModal:c,body:S(),header:y(),footer:a(),isLoading:!1})}const J=()=>{const{getData:t,subCategoryData:c,isLoadingGet:p,deleteData:C,isLoadingDelete:h}=E(a=>a),[n,d]=u.useState(!1),[x,g]=u.useState(!1),b={search:"",page:1,limit:10,fromDate:null,toDate:null,sortBy:"createdAt",sortOrder:"DESC",isExcelExport:"false"},[l,o]=u.useState(b),j=()=>{t(l),g(!1),d(!1)};u.useEffect(()=>{t(l)},[l]);const m=a=>{o(s=>({...s,sortBy:a,sortOrder:s.sortOrder==="ASC"?"DESC":"ASC"}))},r=[];r.push({name:"Action",disableViewClick:!0,contentClass:"action-wrap",thclass:"actions-edit employee-actn-edit",cell:a=>i(a)});const i=a=>e.jsxs(e.Fragment,{children:[e.jsx(D,{id:"edit",place:"bottom",content:"Edit",style:{backgroundColor:"#2ca0da"}}),e.jsx(D,{id:"delete",place:"bottom",content:"Delete",style:{backgroundColor:"#2ca0da"}}),e.jsx("img",{src:V,alt:"edit","data-tooltip-id":"edit",onClick:()=>{g(a)}}),e.jsx("img",{src:H,alt:"delete","data-tooltip-id":"delete",onClick:()=>{d(a)}})]}),f=[{name:"Name",selector:"name",contentClass:"user-pic"},{name:"Category",selector:"category",contentClass:"user-pic",cell:a=>{var s;return e.jsx("span",{children:(s=a==null?void 0:a.category)==null?void 0:s.name})}},{name:"Created Date",selector:"createdAt",cell:a=>e.jsx("span",{children:T(a==null?void 0:a.createdAt)}),sort:!0},...r],y=P.debounce(a=>{console.log(" searchValue",a),o(s=>({...s,search:a,page:1}))},500),S=()=>{n!=null&&n.id&&C(n==null?void 0:n.id,()=>{j()})};return e.jsxs(e.Fragment,{children:[e.jsx($,{addButton:{name:"Add Item",type:"button",action:()=>g(!0)},hideFilter:!0,submitFilter:a=>{const{fromDate:s,toDate:v,...F}=a;o({...l,...F,fromDate:s?I(s).format("YYYY-MM-DD"):null,toDate:v?I(v).format("YYYY-MM-DD"):null,page:"1"})},clearOptions:()=>{o(b)},onSearch:y}),e.jsx(B,{pagination:{currentPage:l.page,limit:l.limit},count:c==null?void 0:c.total,columns:f,data:c==null?void 0:c.data,isLoading:p,onPageChange:a=>o({...l,page:a}),setLimit:a=>o({...l,limit:a}),onSortChange:m,wrapClasses:"inventory-table-wrap"}),x&&e.jsx(G,{showModal:x,closeModal:()=>g(!1),onRefreshSubCategory:j}),n&&e.jsx(R,{isDelete:!0,isLoading:h,showModal:n,closeModal:()=>d(!1),message:`Are you sure you want to delete this ${n==null?void 0:n.name}?`,onCancel:()=>d(!1),onSubmit:S})]})};export{J as default};
