import{G as h,x as Z,y as D,b as I,r as j,j as a,n as Y,l as G,e as B,h as S,f as R,g as V,K as $,M as E,i as H}from"./index-DaK327To.js";import{e as T}from"./edit-iaQC2oZw.js";import{s as q,z as L}from"./zod-Bs86SuPh.js";const z=s=>h.post("/category",s),K=(s,i)=>h.put(`/category/${s}`,i),J=s=>h.get("/category",{params:s}),O=s=>h.delete(`/category/${s}`),C={postData:z,patchData:K,getData:J,deleteData:O},A=Z(s=>({isLoading:!1,isLoadingGet:!1,isLoadingDelete:!1,errorMessage:"",successMessage:"",categoryData:null,postData:async(i,m)=>{var d,u,o,t,l,p,n,c;try{s({isLoading:!0});const{data:e}=await C.postData(i),{success:f}=D.getState();f(((u=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:u.message)??(e==null?void 0:e.message)),s({successMessage:((t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message)??(e==null?void 0:e.message),isLoading:!1}),m&&m()}catch(e){const{error:f}=D.getState();s({errorMessage:((p=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:p.message)??(e==null?void 0:e.message),isLoading:!1}),f(((c=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:c.message)??e.message)}},patchData:async(i,m)=>{var d,u,o,t,l,p,n,c;try{s({isLoading:!0});const{id:e,...f}=i,{data:g}=await C.patchData(e,f),{success:b}=D.getState();b(((u=(d=g==null?void 0:g.response)==null?void 0:d.data)==null?void 0:u.message)??(g==null?void 0:g.message)),m&&m(),s({successMessage:((t=(o=g==null?void 0:g.response)==null?void 0:o.data)==null?void 0:t.message)??(g==null?void 0:g.message),isLoading:!1})}catch(e){const{error:f}=D.getState();s({errorMessage:((p=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:p.message)??(e==null?void 0:e.message),isLoading:!1}),f(((c=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:c.message)??e.message)}},getData:async i=>{var m,d,u,o;try{s({isLoadingGet:!0});const{data:t}=await C.getData(i),l=t;s({categoryData:l==null?void 0:l.data,isLoadingGet:!1})}catch(t){const{error:l}=D.getState();s({errorMessage:((d=(m=t==null?void 0:t.response)==null?void 0:m.data)==null?void 0:d.message)??(t==null?void 0:t.message),isLoadingGet:!1}),l(((o=(u=t==null?void 0:t.response)==null?void 0:u.data)==null?void 0:o.message)??t.message)}},deleteData:async(i,m)=>{var d,u,o,t,l,p;try{s({isLoadingDelete:!0});const{data:n}=await C.deleteData(i),c=n;s({categoryData:c==null?void 0:c.data,successMessage:((u=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:u.message)??(n==null?void 0:n.message),isLoadingDelete:!1}),m&&m()}catch(n){const{error:c}=D.getState();s({errorMessage:((t=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:t.message)??(n==null?void 0:n.message),isLoadingDelete:!1}),c(((p=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:p.message)??n.message)}}})),Q=L.object({name:L.string().nonempty("Name is required").max(20,"Name must be 10 characters or less"),isEZPass:L.boolean().optional()});function U({showModal:s,closeModal:i,onRefreshCategory:m}){const{register:d,handleSubmit:u,formState:{errors:o},setValue:t,reset:l}=I({resolver:q(Q),defaultValues:{name:"",isEZPass:!1}}),{postData:p,patchData:n,isLoading:c}=A(y=>y);j.useEffect(()=>{s!=null&&s.id?(t("name",(s==null?void 0:s.name)||""),t("isEZPass",(s==null?void 0:s.isEZPass)||!1)):l()},[s==null?void 0:s.id]);const e=y=>{s!=null&&s.id?n({id:s.id,...y},()=>{m()}):p(y,()=>{m()}),i()},f=()=>a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"modal-title",children:s!=null&&s.id?"Edit Category":"Add Category"}),a.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:i})]}),g=()=>a.jsx(a.Fragment,{children:a.jsx("div",{className:"modal-body custom-scroll",children:a.jsx("div",{className:"set-dealine-wrp",children:a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"name",className:"form-label",children:["Name",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx("input",{type:"text",id:"name",className:"form-control",autoComplete:"off",maxLength:20,...d("name")}),o.name&&a.jsx("span",{className:"error",children:o.name.message})]})}),a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"isEZPass",className:"form-label me-2",children:"EZ Pass"}),a.jsx("input",{type:"checkbox",id:"isEZPass",className:"form-check-input",...d("isEZPass")}),o.isEZPass&&a.jsx("span",{className:"error",children:o.isEZPass.message})]})})]})})})}),b=()=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"modal-footer bottom-btn-sec",children:[a.jsx("button",{type:"button",className:"btn btn-cancel",onClick:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-submit",disabled:c,onClick:u(e),children:c?"Loading...":"Save"})]})});return a.jsx(Y,{className:"modal fade category-mgmt-modal show",dialgName:"modal-dialog-scrollable",show:!!s,closeModal:i,body:g(),header:f(),footer:b(),isLoading:!1})}const M=()=>{const{getData:s,categoryData:i,isLoadingGet:m,deleteData:d,isLoadingDelete:u}=A(r=>r),[o,t]=j.useState(!1),[l,p]=j.useState(!1),n={search:"",page:1,limit:10,fromDate:null,toDate:null,sortBy:"createdAt",sortOrder:"DESC",isExcelExport:"false"},[c,e]=j.useState(n),f=()=>{s(c),p(!1),t(!1)};j.useEffect(()=>{s(c)},[c]);const g=r=>{e(x=>({...x,sortBy:r,sortOrder:x.sortOrder==="ASC"?"DESC":"ASC"}))},b=[];b.push({name:"Action",contentClass:"action-wrap",disableViewClick:!0,thclass:"actions-edit employee-actn-edit",cell:r=>y(r)});const y=r=>a.jsxs(a.Fragment,{children:[a.jsx(E,{id:"edit",place:"bottom",content:"Edit",style:{backgroundColor:"#2ca0da"}}),a.jsx(E,{id:"delete",place:"bottom",content:"Delete",style:{backgroundColor:"#2ca0da"}}),a.jsx("img",{src:T,alt:"edit","data-tooltip-id":"edit",onClick:()=>{p(r)}}),a.jsx("img",{src:H,alt:"delete","data-tooltip-id":"delete",onClick:()=>{t(r)}})]}),v=[{name:"Category Name",selector:"name",contentClass:"user-pic"},{name:"Total Items",selector:"totalItems",contentClass:"user-pic"},{name:"Loaned Items",selector:"loanedItems",contentClass:"user-pic"},{name:"Available Items",selector:"availableItems",contentClass:"user-pic"},{name:"Category Created Date",selector:"createdAt",cell:r=>a.jsx("span",{children:$(r==null?void 0:r.createdAt)})},...b],P=G.debounce(r=>{console.log(" searchValue",r),e(x=>({...x,search:r,page:1}))},500),k=()=>{o!=null&&o.id&&d(o==null?void 0:o.id,()=>{f()})};return a.jsxs(a.Fragment,{children:[a.jsx(B,{addButton:{name:"Add Item",type:"button",action:()=>p(!0)},hideFilter:!0,submitFilter:r=>{const{fromDate:x,toDate:N,...F}=r;e({...c,...F,fromDate:x?S(x).format("YYYY-MM-DD"):null,toDate:N?S(N).format("YYYY-MM-DD"):null,page:"1"})},clearOptions:()=>{e(n)},onSearch:P}),a.jsx(R,{pagination:{currentPage:c.page,limit:c.limit},count:i==null?void 0:i.total,columns:v,data:i==null?void 0:i.data,isLoading:m,onPageChange:r=>e({...c,page:r}),setLimit:r=>e({...c,limit:r}),onSortChange:g,wrapClasses:"inventory-table-wrap"}),l&&a.jsx(U,{showModal:l,closeModal:()=>p(!1),onRefreshCategory:f}),o&&a.jsx(V,{isDelete:!0,isLoading:u,showModal:o,closeModal:()=>t(!1),message:`Are you sure you want to delete this ${o==null?void 0:o.name}?`,onCancel:()=>t(!1),onSubmit:k})]})};export{M as default};
